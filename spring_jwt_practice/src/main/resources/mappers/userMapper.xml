<?xml version="1.0" encoding="UTF-8"?>
 
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.java.mappers.UserMapper">

	<select id="login" resultType="Integer">
			
		select count(*) from jwtTest where userId=#{userId} and userPw=#{userPw}
	
	</select>


	<insert id="signup">
		
		insert into jwtTest(userId,userPw) values (#{userId}, #{userPw})
	
	</insert>

	<!-- 아이디 중복체크 -->
	<select id="signupcheckid" resultType="Integer">
		
		select count(*) from jwtTest where userId=#{userId}
		
	</select>
	
	 <select id="listAll" resultType="com.java.vo.UserVO">
    <![CDATA[
        select * from jwtTest 
        where pid > 0
    ]]>
    </select>
    
    <!-- blacklist에서 관리할 토큰 저장 -->
    <insert id="logout">
    
    	insert into blacklist(logoutId,logoutToken,logoutTime) values (#{logoutId},#{logoutToken},SYSDATE())
    
    </insert>
    
    <!-- blacklist 테이블에 동일한 토큰 중복등록 방지 -->
    <select id="tokenCount" resultType = "Integer">
    	
    	select count(*) from blacklist where logoutToken=#{logoutToken}
    	
    </select>

</mapper> 